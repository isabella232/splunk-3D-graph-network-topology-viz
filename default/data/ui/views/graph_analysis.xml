<form script="searchcontrolsevents.js" theme="dark">
  <init>
    <set token="show_results">true</set>
    <set token="beforeSearch">true</set>
  </init>
  <label>Graph Analysis Framework</label>
  <fieldset submitButton="false"></fieldset>
  <row>
    <panel depends="$alwaysHideThisPanel$">
      <input type="text" token="searchString">
        <label>$searchString$</label>
      </input>
    </panel>
  </row>
  <row>
    <panel>
      <html>
        <h1>1. Input Data</h1>
      </html>
    </panel>
  </row>
  <row>
    <panel>
      <html>
        <div>
            <div class="main-area">
                <div id="mysearchbar1"/>
                <div id="mysearchcontrols1"/>
            </div>
        </div>
      </html>
    </panel>
  </row>
  <row>
    <panel depends="$searchString$">
      <table>
        <title>Search results</title>
        <search base="base">
          <query>| table *</query>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
    <panel depends="$beforeSearch$">
      <html>
        <p>This dashboard is designed to help you generate some graph analytics on your own data. The search bar can be used to input some base data and graph visuals can then be generated by selecting a source field (such as src_ip) as destination field (such as dest_ip) and a weight field (such as the count of connections between src_ip and dest_ip pairs).</p>
        <br/>
        <p>The search bar below is pre-populated to return a selection of records from the <a href="https://www.hs-coburg.de/forschung/forschungsprojekte-oeffentlich/informationstechnologie/cidds-coburg-intrusion-detection-data-sets.html">Coburg Intrusion Detection Data Set (CIDDS)</a>. These records will be used here as an example to demonstrate how to explore some network data.</p>
        <br/>
        <p>Feel free to replace the contents in the search bar with your own search, select the source, destination and weight fields to visualise your own results.</p>
      </html>
    </panel>
  </row>
  <row>
    <panel depends="$searchString$">
      <html>
        <h1>2. Select Fields</h1>
      </html>
    </panel>
  </row>
  <row>
    <panel depends="$searchString$">
      <input type="dropdown" token="source">
        <label>Select Source Field:</label>
        <fieldForLabel>field</fieldForLabel>
        <fieldForValue>field</fieldForValue>
        <search base="base">
          <query>| table *
| fieldsummary
| table field
| dedup field</query>
        </search>
      </input>
      <input type="dropdown" token="destination">
        <label>Select Destination Field:</label>
        <fieldForLabel>field</fieldForLabel>
        <fieldForValue>field</fieldForValue>
        <search base="base">
          <query>| table *
| fieldsummary
| table field
| dedup field</query>
        </search>
      </input>
      <input type="dropdown" token="weight">
        <label>Select Weight Field:</label>
        <fieldForLabel>field</fieldForLabel>
        <fieldForValue>field</fieldForValue>
        <search base="base">
          <query>| table *
| fieldsummary
| search numeric_count&gt;0
| table field
| dedup field</query>
        </search>
      </input>
    </panel>
  </row>
  <row>
    <panel depends="$searchString$">
      <html>
        <h1>3. Visualise the Results</h1>
      </html>
    </panel>
  </row>
  <row>
    <panel depends="$source$,$destination$,$weight$,$searchString$">
      <viz type="splunk-3D-graph-network-topology-viz.3d_graph_network_topology_viz">
        <title>Simple graph visualisation based on the search results</title>
        <search base="base">
          <query>| table "$source$" "$destination$" "$weight$"</query>
        </search>
        <option name="drilldown">none</option>
        <option name="height">372</option>
      </viz>
    </panel>
  </row>
  <row>
    <panel depends="$source$,$destination$,$weight$,$searchString$">
      <html>
        <h1>4. Further Analysis</h1>
      </html>
    </panel>
  </row>
  <row>
    <panel depends="$source$,$destination$,$weight$,$searchString$">
      <single>
        <title>Centrality Measures</title>
        <search>
          <query>| makeresults | eval text="Do you want to identify the most critical nodes in your network?" | table text</query>
        </search>
        <option name="drilldown">all</option>
        <option name="height">50</option>
        <drilldown>
          <link>/app/splunk-3D-graph-network-topology-viz/graph_analysis_centrality?form.search=$searchString$&amp;form.source=$source$&amp;form.destination=$destination$&amp;form.weight=$weight$</link>
        </drilldown>
      </single>
      <html>
        <div style="text-align:center;">
          <div class="icon">
          <a>
            <img src="/static/app/splunk-3D-graph-network-topology-viz/images/weighted.png" width="300" height="300"/>
          </a>
          </div>
        </div>
      </html>
    </panel>
    <panel depends="$source$,$destination$,$weight$,$searchString$">
      <single>
        <title>Minimum Spanning Tree</title>
        <search>
          <query>| makeresults | eval text="Do you want to find the shortest path through your network?" | table text</query>
        </search>
        <option name="drilldown">all</option>
        <option name="height">50</option>
        <drilldown>
          <link>/app/splunk-3D-graph-network-topology-viz/graph_analysis_minimum_spanning_tree?form.search=$searchString$&amp;form.source=$source$&amp;form.destination=$destination$&amp;form.weight=$weight$</link>
        </drilldown>
      </single>
      <html>
        <div style="text-align:center;">
          <div class="icon">
          <a>
            <img src="/static/app/splunk-3D-graph-network-topology-viz/images/spine.png" width="300" height="300"/>
          </a>
          </div>
        </div>
      </html>
    </panel>
    <panel depends="$source$,$destination$,$weight$,$searchString$">
      <single>
        <title>Connected Components</title>
        <search>
          <query>| makeresults | eval text="Do you want to analyse the groups of connected nodes in your network?" | table text</query>
        </search>
        <option name="drilldown">all</option>
        <option name="height">50</option>
        <drilldown>
          <link>/app/splunk-3D-graph-network-topology-viz/graph_analysis_connected_components?form.search=$searchString$&amp;form.source=$source$&amp;form.destination=$destination$&amp;form.weight=$weight$</link>
        </drilldown>
      </single>
      <html>
        <div style="text-align:center;">
          <div class="icon">
            <a>
              <img src="/static/app/splunk-3D-graph-network-topology-viz/images/connected.png" width="300" height="300"/>
            </a>
          </div>
        </div>
      </html>
    </panel>
    <panel depends="$source$,$destination$,$weight$,$searchString$">
      <single>
        <title>Community Detection</title>
        <search>
          <query>| makeresults | eval text="Do you want to analyse the groups of related nodes in your network?" | table text</query>
        </search>
        <option name="drilldown">all</option>
        <option name="height">50</option>
        <drilldown>
          <link>/app/splunk-3D-graph-network-topology-viz/graph_analysis_label_propagation?form.search=$searchString$&amp;form.source=$source$&amp;form.destination=$destination$&amp;form.weight=$weight$</link>
        </drilldown>
      </single>
      <html>
        <div style="text-align:center;">
          <div class="icon">
          <a>
            <img src="/static/app/splunk-3D-graph-network-topology-viz/images/label.png" width="300" height="300"/>
          </a>
          </div>
        </div>
      </html>
    </panel>
  </row>
</form>