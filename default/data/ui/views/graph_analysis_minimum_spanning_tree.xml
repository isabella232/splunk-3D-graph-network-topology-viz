<form theme="dark">
  <label>Minimum Spanning Tree</label>
  <fieldset submitButton="false"></fieldset>
  <row>
    <panel depends="$alwaysHidePanel$">
      <input type="text" token="search">
        <label>search</label>
      </input>
      <input type="text" token="source">
        <label>source</label>
      </input>
      <input type="text" token="destination">
        <label>destination</label>
      </input>
      <input type="text" token="weight">
        <label>weight</label>
      </input>
    </panel>
  </row>
  <row>
    <panel>
      <html>A <a href="https://en.wikipedia.org/wiki/Minimum_spanning_tree">Minimum Spanning Tree</a> is an algorithm that aims to determine the nodes and connections that form the shortest path across the network - or the 'spine' of the network. It analyses the nodes and connections across a given network and includes each connection in turn starting with the connection with the lowest weighting until all the nodes are connected, ignoring any connections that create a cycle in the network. Combined with some centrality measures it can help identify the most important path across a network.</html>
    </panel>
  </row>
  <row>
    <panel>
      <viz type="splunk-3D-graph-network-topology-viz.3d_graph_network_topology_viz">
        <title>Minimum Spanning Tree - Network Spine Visualisation</title>
        <search base="base">
          <query>| table *
| eventstats max($weight$) as max_count
| eval weight=(1-($weight$/max_count))
| fit MinimumSpanningTree $source$ $destination$ weight='weight'
| sort - "$source$"</query>
        </search>
        <option name="drilldown">none</option>
        <option name="height">659</option>
        <option name="refresh.display">progressbar</option>
        <option name="splunk-3D-graph-network-topology-viz.3d_graph_network_topology_viz.bgColor">#222527</option>
        <option name="splunk-3D-graph-network-topology-viz.3d_graph_network_topology_viz.cameraController">trackball</option>
        <option name="splunk-3D-graph-network-topology-viz.3d_graph_network_topology_viz.dagMode">null</option>
        <option name="splunk-3D-graph-network-topology-viz.3d_graph_network_topology_viz.enable3D">0</option>
        <option name="splunk-3D-graph-network-topology-viz.3d_graph_network_topology_viz.lkColor">#777777</option>
        <option name="splunk-3D-graph-network-topology-viz.3d_graph_network_topology_viz.ndColor">#999999</option>
        <option name="splunk-3D-graph-network-topology-viz.3d_graph_network_topology_viz.showAnimationBar">1</option>
      </viz>
    </panel>
    <panel>
      <table>
        <title>Raw Input Data</title>
        <search id="base">
          <query>$search$ | table $source$ $destination$ $weight$</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="count">20</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="percentagesRow">false</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">false</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
</form>